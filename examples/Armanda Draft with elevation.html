<!DOCTYPE html>
<html>
  <head>
    <meta name="NationalPark" content="initial-scale=1.0, user-scalable=no" />
    <meta charset="utf-8">
    <style type="text/css">
      html { height: 100% }
      body { height: 100%; margin: 0; padding: 0 }
      #map-canvas { height: 100% }
    </style>
    <script type="text/javascript"
      src="https://maps.google.co.za/maps/api/js?key=AIzaSyApLMBP3GSrHpVJgIHrCRkdeizAHUD_NHI&sensor=false&language=en&libraries=drawing&sensor=true">
    </script>
    <script type="text/javascript">
    
    
    function initialize() {
        var mapOptions = {
          center: new google.maps.LatLng(-24.011389, 31.485278),
          zoom: 8, styles: [ { stylers: [ { hue: "#6BF2FF" } ] } ]
          
        };
        var map = new google.maps.Map(document.getElementById("map-canvas"),
            mapOptions);
            
            
  
   
      




 
    
      
   //////////ALTITUDE//////////////////
   
var elevator;
var map;
var infowindow = new google.maps.InfoWindow();
var denali = new google.maps.LatLng(-24.011389, 31.485278);


  var mapOptions = {
    zoom: 8,
    center: denali,
    mapTypeId: 'terrain'
  }

  elevator = new google.maps.ElevationService();

  google.maps.event.addListener(map, 'click', getElevation);
//}

function getElevation(event) {

  var locations = [];

  var clickedLocation = event.latLng;
  locations.push(clickedLocation);

  var positionalRequest = {
    'locations': locations
  }

  elevator.getElevationForLocations(positionalRequest, function(results, status) {
    if (status == google.maps.ElevationStatus.OK) {


      if (results[0]) {

        infowindow.setContent('The altitude of this point <br>is ' + results[0].elevation + ' meters.');
        infowindow.setPosition(clickedLocation);
        infowindow.open(map);
      } else {
        alert('No results found');
      }
    } else {
      alert('Elevation service failed due to: ' + status);
    }
  });
}   

      
          
   ///////////Polyline overlay///////////////////   
      
      
var poly;
var map;

  var polyOptions = {
    strokeColor: '#000000',
    strokeOpacity: 1.0,
    strokeWeight: 3,
    editable:true,
      };
  poly = new google.maps.Polyline(polyOptions);
  poly.setMap(map);


  google.maps.event.addListener(map, 'click', addLatLng);


function addLatLng(event) {
  var path = poly.getPath();

  path.push(event.latLng);

  var marker = new google.maps.Marker({
    position: event.latLng,
    title: '#' + path.getLength(),
    icon: 'https://chart.googleapis.com/chart?chst=d_map_pin_letter&chld='+ (event.latLng) +'|FF1905|0000FF',
    editable:true,
    map: map
  });

  points = document.getElementById("points");
  new_points = points.innerHTML  + "<br />" + event.latLng + "&nbsp<div id=\"" + path.length +  "elevation\"> </div>"; 
  points.innerHTML = new_points;
  
  locations = [];
  locations.push(event.latLng);

  var positionalRequest = {
    'locations': locations
  }
  
  elevator.getElevationForLocations(positionalRequest, function(results, status) {
    if (status == google.maps.ElevationStatus.OK && results[0]) {
        elevation = document.getElementById(poly.getPath().length + "elevation");
        elevation.innerHTML = results[0].elevation;
    }
  });





}



//var retrieve
//retrieve = { lat: 'latlong'};
 //Object.toJSON(points.innerHTML);


 
 
 
 
 

}
///////Le curly brace juste ci-dessus ferme la fonction globale

   
      
   google.maps.event.addDomListener(window, 'load', initialize);   
      



    </script>
  </head>
  <body>
<div id="points">
     Get coordinates: 
  </div>
    <div id="map-canvas"></div>     
</script>
  </body>
</html>